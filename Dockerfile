FROM node:22-alpine

ARG APORT
ARG ADBHOST
ARG ADBUSER
ARG ADBPASSWORD
ARG ADATABASE
ARG AJWT_SECRET
ARG AJWT_EXPIRE

WORKDIR /usr/src/app

ENV PORT $APORT
ENV DBHOST $ADBHOST
ENV DBUSER $ADBUSER
ENV DBPASSWORD $ADBPASSWORD
ENV DATABASE $ADATABASE
ENV JWT_SECRET $AJWT_SECRET
ENV JWT_EXPIRE $AJWT_EXPIRE

COPY package*.json ./

RUN npm install

COPY . .

EXPOSE 3300


ENTRYPOINT sleep 5 && npm run seed && npm start


